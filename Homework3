#Problem 1
a=0
FactorialFunction<-function(Inputnumber){
  if(Inputnumber==0){
    Result<-1
  } else {
    Result<- Inputnumber
    while(Inputnumber>1){
      Result<-(Inputnumber-1)*Result
      Inputnumber<-Inputnumber-1
    }
      
  }
  return (Result)
}
FactorialFunction (a)

#Problem 2
v<-c(1,4,6,7)

sdf<-function(InputVector) {
  avg=sum(InputVector)/length(InputVector)
  SumDiff<- sum((InputVector-avg)^2)
  FinalRes<-sqrt(sum((InputVector-avg)^2)/(length(InputVector)-1))
  return(FinalRes)
}
sdf(v)
sd(v)

#Problem 4
library(nycflights13)
library(dplyr)
library(tidyverse)
library(tidyquant)
#4.1
a<-flights %>%
  group_by(carrier,dest) %>%
  select(carrier,dest) %>%
  summarise(NrFlights=n()) %>%
  arrange(desc(NrFlights)) %>%
  slice_head()''

#4.2
a<-flights %>%
  group_by(carrier) %>%
  summarise(most=max(arr_delay, na.rm=TRUE)) %>%
  ungroup()
view(a)

#4.3
#most miles
b<-flights %>%
  group_by(tailnum)%>%
  select(tailnum,distance) %>%
  summarise(mostmiles=sum(distance)) %>%
 arrange(tailnum, desc(mostmiles)) %>%
 slice_head(n=3)
view(b)

#least miles
c<-flights %>%
  group_by(tailnum)%>%
  select(tailnum,distance) %>%
  summarise(leastmiles=sum(distance)) %>%
  arrange(tailnum, desc(leastmiles)) %>%
  slice_tail(n=3)
view(c)

#4.4
# i understand it that way: We should find which are the earliest flights each day and which are the latest because we are looking for first and last flights.

d<- flights %>%
  group_by(day, dep_time) %>%
  select(day,flight) %>%
  summarise(maxx=max(dep_time),month=2, year=2013) %>% # i think that we should find which is the biggest dep_time so that we can see the last flights for each day
ungroup()
view(d) 
  

v<- flights %>%
  group_by(day, dep_time) %>%
  select(day,flight) %>%
  summarise(minn=min(dep_time), month=2, year=2013) %>% 
na.omit(dep_time) # i googled this function
view(v)  # i am not sure how to remove the NAs here

#4.5
 f<-flights %>%
   group_by(carrier) %>%
   select(carrier,distance) %>%
   summarise(most=max(distance), month=3, year=2013) %>%
   arrange(desc(most)) %>%
   slice_head() #most miles
 view(f)
  
 p<-flights %>%
   group_by(carrier) %>%
   select(carrier,distance) %>%
   summarise(least=min(distance), month=3, year=2013) %>%
   arrange(desc(least)) %>%
   slice_head() #least miles
 view(p)

#4.6
 
delayy<-flights %>%
   group_by(month) %>%
   summarise (delayss=count(arr_delay>60, na.rm=TRUE)) %>% 
   arrange(desc(delayss))
 view(delayy)
   
#4.7
# I am not sure how to deal with this problem.
 
#4.8
 
 s<-flights %>%
   group_by(month) %>%
 summarise(StandardDEV=STDEV(arr_delay), na.rm=TRUE) #It did not work with my sdf function, there were only NAs.
 view(s)
   
 o<-flights %>%
   group_by(dest) %>%
   summarise(StandardDEV=STDEV(arr_delay), na.rm=TRUE)
 view(o)
   
